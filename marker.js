"use strict";

var _babelHelpers = require("babel-runtime/helpers")["default"];
var _core = require("babel-runtime/core-js")["default"];
var _require = require("layer");

var Layer = _require.Layer;
var _require2 = require("utils");

var accessors = _require2.accessors;
var uniqueId = _require2.uniqueId;
var Marker = (function (Layer) {
  function Marker() {
    _babelHelpers.classCallCheck(this, Marker);

    _babelHelpers.get(_core.Object.getPrototypeOf(Marker.prototype), "constructor", this).call(this);

    var defaults = {
      type: "marker",
      id: uniqueId(name),
      displayHandle: true
    };

    this.params(defaults);
    this.width(1);
    this.color("#000000");
    this.opacity("0.7");
    this.data([{ x: 0 }]);

    this.x(function (d) {
      var v = arguments[1] === undefined ? null : arguments[1];
      if (v !== null) {
        return d.x = parseFloat(v, 10);
      }
      return d.x;
    });
  }

  _babelHelpers.inherits(Marker, Layer);

  _babelHelpers.prototypeProperties(Marker, null, {
    xZoom: {
      value: function xZoom() {
        this.update();
      },
      writable: true,
      configurable: true
    },
    setCurrentTime: {
      value: function setCurrentTime(currentTime) {
        var x = this.x();

        if (!Array.isArray(currentTime)) {
          x(this.data()[0], currentTime);
        } else {
          this.data(currentTime);
        }

        return this;
      },
      writable: true,
      configurable: true
    },
    handleDrag: {
      value: function handleDrag(el, e) {
        this.move(el, e.originalEvent.dx, e.originalEvent.dy);
      },
      writable: true,
      configurable: true
    },
    move: {
      value: function move(item, dx, dy) {
        item = this.d3.select(item);
        var datum = item.datum();

        var xScale = this.base.xScale;
        var xRange = xScale.range();
        var xAccessor = this.x();
        var x = xScale(xAccessor(datum));
        var targetX = x + dx;

        if (targetX >= xRange[0] && targetX <= xRange[1]) {
          x = targetX;
        }

        xAccessor(datum, xScale.invert(x));
        // redraw element
        this.draw(item);
      },
      writable: true,
      configurable: true
    },
    update: {
      value: function update() {
        var data = arguments[0] === undefined ? null : arguments[0];
        if (data !== null && !Array.isArray(data)) {
          data = [data];
        }
        _babelHelpers.get(_core.Object.getPrototypeOf(Marker.prototype), "update", this).call(this, data);

        this.items = this.g.selectAll("." + this.param("unitClass")).data(this.data());

        var sel = this.items.enter().append("g").classed("item", true).classed(this.param("unitClass"), true);

        var handleHeight = 8;
        var y = this.param("displayHandle") ? handleHeight : 0;

        sel.append("line").style("stroke-width", this.width()).style("stroke", this.color()).style("opacity", this.opacity()).attr("x1", 0).attr("x2", 0).attr("y1", y).attr("y2", this.param("height"));

        if (this.param("displayHandle")) {
          var area = this.d3.svg.area().x(function (d) {
            return d;
          }).y0(0).y1(handleHeight);

          sel.append("path").attr("d", area([-4, 4])).style("opacity", this.opacity()).style("fill", this.color());
        }

        this.items.exit().remove();
      },
      writable: true,
      configurable: true
    },
    draw: {
      value: function draw() {
        var el = arguments[0] === undefined ? null : arguments[0];
        el = el || this.items;

        var xScale = this.base.xScale;
        var xAccessor = this.x();
        var x = function (d) {
          return xScale(xAccessor(d));
        };

        el.attr("transform", function (d) {
          return "translate(" + x(d) + ", 0)";
        });
      },
      writable: true,
      configurable: true
    }
  });

  return Marker;
})(Layer);

accessors.getFunction(Marker.prototype, ["color", "opacity", "width", "x"]);

function factory() {
  return new Marker();
}
factory.Marker = Marker;

module.exports = factory;

//# sourceMappingURL=data:application/json;base64,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QUFHLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDO0FBQzlCLFlBQUksU0FBUyxHQUFHLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQztBQUN6QixZQUFJLENBQUMsR0FBRyxVQUFDLENBQUMsRUFBSztBQUFFLGlCQUFPLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUFFLENBQUM7O0FBRWhELFVBQUUsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLFVBQUMsQ0FBQyxFQUFLO0FBQzFCLGlCQUFPLFlBQVksR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFDO1NBQ3JDLENBQUMsQ0FBQztPQUNKOzs7Ozs7U0EvR0csTUFBTTtHQUFTLEtBQUs7O0FBa0gxQixTQUFTLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxTQUFTLEVBQ3BDLENBQUMsT0FBTyxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQ25DLENBQUM7O0FBRUYsU0FBUyxPQUFPLEdBQUc7QUFBRSxTQUFPLElBQUksTUFBTSxFQUFFLENBQUM7Q0FBRTtBQUMzQyxPQUFPLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQzs7QUFFeEIsTUFBTSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMiLCJmaWxlIjoiLi9tYXJrZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciB7IExheWVyIH0gPSByZXF1aXJlKCdsYXllcicpO1xudmFyIHsgYWNjZXNzb3JzLCB1bmlxdWVJZCB9ID0gcmVxdWlyZSgndXRpbHMnKTtcblxuY2xhc3MgTWFya2VyIGV4dGVuZHMgTGF5ZXIge1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICB2YXIgZGVmYXVsdHMgPSB7XG4gICAgICB0eXBlOiAnbWFya2VyJyxcbiAgICAgIGlkOiB1bmlxdWVJZChuYW1lKSxcbiAgICAgIGRpc3BsYXlIYW5kbGU6IHRydWVcbiAgICB9O1xuXG4gICAgdGhpcy5wYXJhbXMoZGVmYXVsdHMpO1xuICAgIHRoaXMud2lkdGgoMSk7XG4gICAgdGhpcy5jb2xvcignIzAwMDAwMCcpO1xuICAgIHRoaXMub3BhY2l0eSgnMC43Jyk7XG4gICAgdGhpcy5kYXRhKFt7IHg6IDAgfV0pO1xuXG4gICAgdGhpcy54KGZ1bmN0aW9uKGQsIHYgPSBudWxsKSB7XG4gICAgICBpZiAodiAhPT0gbnVsbCkgeyByZXR1cm4gZC54ID0gcGFyc2VGbG9hdCh2LCAxMCk7IH1cbiAgICAgIHJldHVybiBkLng7XG4gICAgfSlcbiAgfVxuXG4gIHhab29tKCkge1xuICAgIHRoaXMudXBkYXRlKCk7XG4gIH1cblxuICBzZXRDdXJyZW50VGltZShjdXJyZW50VGltZSkge1xuICAgIHZhciB4ID0gdGhpcy54KCk7XG5cbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoY3VycmVudFRpbWUpKSB7XG4gICAgICB4KHRoaXMuZGF0YSgpWzBdLCBjdXJyZW50VGltZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZGF0YShjdXJyZW50VGltZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBoYW5kbGVEcmFnKGVsLCBlKSB7XG4gICAgdGhpcy5tb3ZlKGVsLCBlLm9yaWdpbmFsRXZlbnQuZHgsIGUub3JpZ2luYWxFdmVudC5keSk7XG4gIH1cblxuICBtb3ZlKGl0ZW0sIGR4LCBkeSkge1xuICAgIGl0ZW0gPSB0aGlzLmQzLnNlbGVjdChpdGVtKTtcbiAgICB2YXIgZGF0dW0gPSBpdGVtLmRhdHVtKCk7XG5cbiAgICB2YXIgeFNjYWxlID0gdGhpcy5iYXNlLnhTY2FsZTtcbiAgICB2YXIgeFJhbmdlID0geFNjYWxlLnJhbmdlKCk7XG4gICAgdmFyIHhBY2Nlc3NvciA9IHRoaXMueCgpO1xuICAgIHZhciB4ID0geFNjYWxlKHhBY2Nlc3NvcihkYXR1bSkpO1xuICAgIHZhciB0YXJnZXRYID0geCArIGR4O1xuXG4gICAgaWYgKHRhcmdldFggPj0geFJhbmdlWzBdICYmIHRhcmdldFggPD0geFJhbmdlWzFdKSB7XG4gICAgICB4ID0gdGFyZ2V0WDtcbiAgICB9XG5cbiAgICB4QWNjZXNzb3IoZGF0dW0sIHhTY2FsZS5pbnZlcnQoeCkpO1xuICAgIC8vIHJlZHJhdyBlbGVtZW50XG4gICAgdGhpcy5kcmF3KGl0ZW0pO1xuICB9XG5cbiAgdXBkYXRlKGRhdGEgPSBudWxsKSB7XG4gICAgaWYgKGRhdGEgIT09IG51bGwgJiYgIUFycmF5LmlzQXJyYXkoZGF0YSkpIHsgZGF0YSA9IFtkYXRhXTsgfVxuICAgIHN1cGVyLnVwZGF0ZShkYXRhKTtcblxuICAgIHRoaXMuaXRlbXMgPSB0aGlzLmcuc2VsZWN0QWxsKCcuJyArIHRoaXMucGFyYW0oJ3VuaXRDbGFzcycpKVxuICAgICAgLmRhdGEodGhpcy5kYXRhKCkpO1xuXG4gICAgdmFyIHNlbCA9IHRoaXMuaXRlbXMuZW50ZXIoKVxuICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAuY2xhc3NlZCgnaXRlbScsIHRydWUpXG4gICAgICAuY2xhc3NlZCh0aGlzLnBhcmFtKCd1bml0Q2xhc3MnKSwgdHJ1ZSk7XG5cbiAgICB2YXIgaGFuZGxlSGVpZ2h0ID0gODtcbiAgICB2YXIgeSA9IHRoaXMucGFyYW0oJ2Rpc3BsYXlIYW5kbGUnKSA/IGhhbmRsZUhlaWdodCA6IDA7XG5cbiAgICBzZWwuYXBwZW5kKCdsaW5lJylcbiAgICAgIC5zdHlsZSgnc3Ryb2tlLXdpZHRoJywgdGhpcy53aWR0aCgpKVxuICAgICAgLnN0eWxlKCdzdHJva2UnLCB0aGlzLmNvbG9yKCkpXG4gICAgICAuc3R5bGUoJ29wYWNpdHknLCB0aGlzLm9wYWNpdHkoKSlcbiAgICAgIC5hdHRyKCd4MScsIDApXG4gICAgICAuYXR0cigneDInLCAwKVxuICAgICAgLmF0dHIoJ3kxJywgeSlcbiAgICAgIC5hdHRyKCd5MicsIHRoaXMucGFyYW0oJ2hlaWdodCcpKVxuXG4gICAgaWYgKHRoaXMucGFyYW0oJ2Rpc3BsYXlIYW5kbGUnKSkge1xuICAgICAgdmFyIGFyZWEgPSB0aGlzLmQzLnN2Zy5hcmVhKClcbiAgICAgICAgLngoZnVuY3Rpb24oZCkgeyByZXR1cm4gZDsgfSlcbiAgICAgICAgLnkwKDApXG4gICAgICAgIC55MShoYW5kbGVIZWlnaHQpO1xuXG4gICAgICBzZWwuYXBwZW5kKCdwYXRoJylcbiAgICAgICAgLmF0dHIoJ2QnLCBhcmVhKFstNCwgNF0pKVxuICAgICAgICAuc3R5bGUoJ29wYWNpdHknLCB0aGlzLm9wYWNpdHkoKSlcbiAgICAgICAgLnN0eWxlKCdmaWxsJywgdGhpcy5jb2xvcigpKTtcbiAgICB9XG5cbiAgICB0aGlzLml0ZW1zLmV4aXQoKS5yZW1vdmUoKTtcbiAgfVxuXG4gIGRyYXcoZWwgPSBudWxsKSB7XG4gICAgZWwgPSBlbCB8fCB0aGlzLml0ZW1zO1xuXG4gICAgdmFyIHhTY2FsZSA9IHRoaXMuYmFzZS54U2NhbGU7XG4gICAgdmFyIHhBY2Nlc3NvciA9IHRoaXMueCgpO1xuICAgIHZhciB4ID0gKGQpID0+IHsgcmV0dXJuIHhTY2FsZSh4QWNjZXNzb3IoZCkpOyB9O1xuXG4gICAgZWwuYXR0cigndHJhbnNmb3JtJywgKGQpID0+IHtcbiAgICAgIHJldHVybiAndHJhbnNsYXRlKCcgKyB4KGQpICsgJywgMCknO1xuICAgIH0pO1xuICB9XG59XG5cbmFjY2Vzc29ycy5nZXRGdW5jdGlvbihNYXJrZXIucHJvdG90eXBlLFxuICBbJ2NvbG9yJywgJ29wYWNpdHknLCAnd2lkdGgnLCAneCddXG4pO1xuXG5mdW5jdGlvbiBmYWN0b3J5KCkgeyByZXR1cm4gbmV3IE1hcmtlcigpOyB9XG5mYWN0b3J5Lk1hcmtlciA9IE1hcmtlcjtcblxubW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5O1xuIl19