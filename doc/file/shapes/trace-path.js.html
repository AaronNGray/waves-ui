<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">shapes/trace-path.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/wavesjs/ui" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/shapes/annotated-marker.js~AnnotatedMarker.html">AnnotatedMarker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/shapes/annotated-segment.js~AnnotatedSegment.html">AnnotatedSegment</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/shapes/base-shape.js~BaseShape.html">BaseShape</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/shapes/cursor.js~Cursor.html">Cursor</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/shapes/dot.js~Dot.html">Dot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/shapes/line.js~Line.html">Line</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/shapes/marker.js~Marker.html">Marker</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/shapes/segment.js~Segment.html">Segment</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/shapes/ticks.js~Ticks.html">Ticks</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/shapes/trace-dots.js~TraceDots.html">TraceDots</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/shapes/trace-path.js~TracePath.html">TracePath</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/shapes/waveform.js~Waveform.html">Waveform</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">shapes/trace-path.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import BaseShape from &apos;./base-shape&apos;;


export default class TracePath extends BaseShape {
  getClassName() { return &apos;trace-common&apos;; }

  _getAccessorList() {
    return { x: 0, mean: 0, range: 0 };
  }

  _getDefaults() {
    return {
      rangeColor: &apos;steelblue&apos;,
      meanColor: &apos;#232323&apos;,
      displayMean: true
    };
  }

  render(renderingContext) {
    if (this.$el) { return this.$el; }
    this.$el = document.createElementNS(this.ns, &apos;g&apos;);
    // range path
    this.$range = document.createElementNS(this.ns, &apos;path&apos;);
    this.$el.appendChild(this.$range);

    // mean line
    if (this.params.displayMean) {
      this.$mean = document.createElementNS(this.ns, &apos;path&apos;);
      this.$el.appendChild(this.$mean);
    }

    return this.$el;
  }

  update(renderingContext, data) {
    // order data by x position
    data = data.slice(0);
    data.sort((a, b) =&gt; this.x(a) &lt; this.x(b) ? -1 : 1);

    if (this.params.displayMean) {
      this.$mean.setAttributeNS(null, &apos;d&apos;, this._buildMeanLine(renderingContext, data));
      this.$mean.setAttributeNS(null, &apos;stroke&apos;, this.params.meanColor);
      this.$mean.setAttributeNS(null, &apos;fill&apos;, &apos;none&apos;);
    }

    this.$range.setAttributeNS(null, &apos;d&apos;, this._buildRangeZone(renderingContext, data));
    this.$range.setAttributeNS(null, &apos;stroke&apos;, &apos;none&apos;);
    this.$range.setAttributeNS(null, &apos;fill&apos;, this.params.rangeColor);
    this.$range.setAttributeNS(null, &apos;opacity&apos;, &apos;0.4&apos;);

    data = null;
  }

  _buildMeanLine(renderingContext, data) {
    let instructions = data.map((datum, index) =&gt; {
      const x = renderingContext.timeToPixel(this.x(datum));
      const y = renderingContext.valueToPixel(this.mean(datum));
      return `${x},${y}`;
    });

    return &apos;M&apos; + instructions.join(&apos;L&apos;);
  }

  _buildRangeZone(renderingContext, data) {
    const length = data.length;
    // const lastIndex = data
    let instructionsStart = &apos;&apos;;
    let instructionsEnd = &apos;&apos;;

    for (let i = 0; i &lt; length; i++) {
      const datum = data[i];
      const mean = this.mean(datum);
      const halfRange = this.range(datum) / 2;

      const x  = renderingContext.timeToPixel(this.x(datum));
      const y0 = renderingContext.valueToPixel(mean + halfRange);
      const y1 = renderingContext.valueToPixel(mean - halfRange);

      const start = `${x},${y0}`;
      const end   = `${x},${y1}`;

      instructionsStart = instructionsStart === &apos;&apos; ?
        start : `${instructionsStart}L${start}`;

      instructionsEnd = instructionsEnd === &apos;&apos; ?
        end : `${end}L${instructionsEnd}`;
    }

    let instructions = `M${instructionsStart}L${instructionsEnd}Z`;
    return instructions;
  }
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.1)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
