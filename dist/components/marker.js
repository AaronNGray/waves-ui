"use strict";

var _babelHelpers = require("babel-runtime/helpers")["default"];

var _core = require("babel-runtime/core-js")["default"];

var _require = require("../helpers/utils");

var uniqueId = _require.uniqueId;
var accessors = _require.accessors;

var _require2 = require("../core/layer");

var Layer = _require2.Layer;

var Marker = (function (Layer) {
  function Marker() {
    _babelHelpers.classCallCheck(this, Marker);

    _babelHelpers.get(_core.Object.getPrototypeOf(Marker.prototype), "constructor", this).call(this);

    var defaults = {
      type: "marker",
      id: uniqueId(name),
      displayHandle: true
    };

    this.params(defaults);
    this.width(1);
    this.color("#000000");
    this.opacity("0.7");
    this.data([{ x: 0 }]);

    this.x(function (d) {
      var v = arguments[1] === undefined ? null : arguments[1];

      if (v === null) {
        return d.x;
      }
      d.x = parseFloat(v, 10);
    });
  }

  _babelHelpers.inherits(Marker, Layer);

  _babelHelpers.prototypeProperties(Marker, null, {
    xZoom: {
      value: function xZoom() {
        this.update();
      },
      writable: true,
      configurable: true
    },
    setCurrentTime: {
      value: function setCurrentTime(currentTime) {
        var x = this.x();

        if (!Array.isArray(currentTime)) {
          x(this.data()[0], currentTime);
        } else {
          this.data(currentTime);
        }

        return this;
      },
      writable: true,
      configurable: true
    },
    handleDrag: {
      value: function handleDrag(el, e) {
        this.move(el, e.originalEvent.dx, e.originalEvent.dy);
      },
      writable: true,
      configurable: true
    },
    move: {
      value: function move(item, dx, dy) {
        item = this.d3.select(item);
        var datum = item.datum();

        var xScale = this.base.xScale;
        var xRange = xScale.range();
        var xAccessor = this.x();
        var x = xScale(xAccessor(datum));
        var targetX = x + dx;

        if (targetX >= xRange[0] && targetX <= xRange[1]) {
          x = targetX;
        }

        xAccessor(datum, xScale.invert(x));
        // redraw element
        this.draw(item);
      },
      writable: true,
      configurable: true
    },
    update: {
      value: function update() {
        var data = arguments[0] === undefined ? null : arguments[0];

        if (data !== null && !Array.isArray(data)) {
          data = [data];
        }
        _babelHelpers.get(_core.Object.getPrototypeOf(Marker.prototype), "update", this).call(this, data);

        this.items = this.g.selectAll("." + this.param("unitClass")).data(this.data());

        var sel = this.items.enter().append("g").classed("item", true).classed(this.param("unitClass"), true);

        var handleHeight = 8;
        var y = this.param("displayHandle") ? handleHeight : 0;

        sel.append("line").style("stroke-width", this.width()).style("stroke", this.color()).style("opacity", this.opacity()).attr("x1", 0).attr("x2", 0).attr("y1", y).attr("y2", this.param("height"));

        if (this.param("displayHandle")) {
          var area = this.d3.svg.area().x(function (d) {
            return d;
          }).y0(0).y1(handleHeight);

          sel.append("path").attr("d", area([-4, 4])).style("opacity", this.opacity()).style("fill", this.color());
        }

        this.items.exit().remove();
      },
      writable: true,
      configurable: true
    },
    draw: {
      value: function draw() {
        var el = arguments[0] === undefined ? null : arguments[0];

        el = el || this.items;

        var xScale = this.base.xScale;
        var xAccessor = this.x();
        var x = function (d) {
          return xScale(xAccessor(d));
        };

        el.attr("transform", function (d) {
          return "translate(" + x(d) + ", 0)";
        });
      },
      writable: true,
      configurable: true
    }
  });

  return Marker;
})(Layer);

accessors.getFunction(Marker.prototype, ["color", "opacity", "width", "x"]);

function factory() {
  return new Marker();
}
factory.Marker = Marker;

module.exports = factory;
//# sourceMappingURL=data:application/json;base64,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SUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUM7QUFDOUIsWUFBSSxTQUFTLEdBQUcsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDO0FBQ3pCLFlBQUksQ0FBQyxHQUFHLFVBQUMsQ0FBQyxFQUFLO0FBQUUsaUJBQU8sTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQUUsQ0FBQzs7QUFFaEQsVUFBRSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsVUFBQyxDQUFDLEVBQUs7QUFDMUIsaUJBQU8sWUFBWSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxNQUFNLENBQUM7U0FDckMsQ0FBQyxDQUFDO09BQ0o7Ozs7OztTQS9HRyxNQUFNO0dBQVMsS0FBSzs7QUFrSDFCLFNBQVMsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFDcEMsQ0FBQyxPQUFPLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxHQUFHLENBQUMsQ0FDbkMsQ0FBQzs7QUFFRixTQUFTLE9BQU8sR0FBRztBQUFFLFNBQU8sSUFBSSxNQUFNLEVBQUUsQ0FBQztDQUFFO0FBQzNDLE9BQU8sQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDOztBQUV4QixNQUFNLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQyIsImZpbGUiOiJlczYvaGVscGVycy96b29tZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciB7IHVuaXF1ZUlkLCBhY2Nlc3NvcnMgfSA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvdXRpbHMnKTtcbnZhciB7IExheWVyIH0gPSByZXF1aXJlKCcuLi9jb3JlL2xheWVyJyk7XG5cbmNsYXNzIE1hcmtlciBleHRlbmRzIExheWVyIHtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgdmFyIGRlZmF1bHRzID0ge1xuICAgICAgdHlwZTogJ21hcmtlcicsXG4gICAgICBpZDogdW5pcXVlSWQobmFtZSksXG4gICAgICBkaXNwbGF5SGFuZGxlOiB0cnVlXG4gICAgfTtcblxuICAgIHRoaXMucGFyYW1zKGRlZmF1bHRzKTtcbiAgICB0aGlzLndpZHRoKDEpO1xuICAgIHRoaXMuY29sb3IoJyMwMDAwMDAnKTtcbiAgICB0aGlzLm9wYWNpdHkoJzAuNycpO1xuICAgIHRoaXMuZGF0YShbeyB4OiAwIH1dKTtcblxuICAgIHRoaXMueChmdW5jdGlvbihkLCB2ID0gbnVsbCkge1xuICAgICAgaWYgKHYgPT09IG51bGwpIHsgcmV0dXJuIGQueDsgfVxuICAgICAgZC54ID0gcGFyc2VGbG9hdCh2LCAxMCk7XG4gICAgfSk7XG4gIH1cblxuICB4Wm9vbSgpIHtcbiAgICB0aGlzLnVwZGF0ZSgpO1xuICB9XG5cbiAgc2V0Q3VycmVudFRpbWUoY3VycmVudFRpbWUpIHtcbiAgICB2YXIgeCA9IHRoaXMueCgpO1xuXG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGN1cnJlbnRUaW1lKSkge1xuICAgICAgeCh0aGlzLmRhdGEoKVswXSwgY3VycmVudFRpbWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRhdGEoY3VycmVudFRpbWUpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgaGFuZGxlRHJhZyhlbCwgZSkge1xuICAgIHRoaXMubW92ZShlbCwgZS5vcmlnaW5hbEV2ZW50LmR4LCBlLm9yaWdpbmFsRXZlbnQuZHkpO1xuICB9XG5cbiAgbW92ZShpdGVtLCBkeCwgZHkpIHtcbiAgICBpdGVtID0gdGhpcy5kMy5zZWxlY3QoaXRlbSk7XG4gICAgdmFyIGRhdHVtID0gaXRlbS5kYXR1bSgpO1xuXG4gICAgdmFyIHhTY2FsZSA9IHRoaXMuYmFzZS54U2NhbGU7XG4gICAgdmFyIHhSYW5nZSA9IHhTY2FsZS5yYW5nZSgpO1xuICAgIHZhciB4QWNjZXNzb3IgPSB0aGlzLngoKTtcbiAgICB2YXIgeCA9IHhTY2FsZSh4QWNjZXNzb3IoZGF0dW0pKTtcbiAgICB2YXIgdGFyZ2V0WCA9IHggKyBkeDtcblxuICAgIGlmICh0YXJnZXRYID49IHhSYW5nZVswXSAmJiB0YXJnZXRYIDw9IHhSYW5nZVsxXSkge1xuICAgICAgeCA9IHRhcmdldFg7XG4gICAgfVxuXG4gICAgeEFjY2Vzc29yKGRhdHVtLCB4U2NhbGUuaW52ZXJ0KHgpKTtcbiAgICAvLyByZWRyYXcgZWxlbWVudFxuICAgIHRoaXMuZHJhdyhpdGVtKTtcbiAgfVxuXG4gIHVwZGF0ZShkYXRhID0gbnVsbCkge1xuICAgIGlmIChkYXRhICE9PSBudWxsICYmICFBcnJheS5pc0FycmF5KGRhdGEpKSB7IGRhdGEgPSBbZGF0YV07IH1cbiAgICBzdXBlci51cGRhdGUoZGF0YSk7XG5cbiAgICB0aGlzLml0ZW1zID0gdGhpcy5nLnNlbGVjdEFsbCgnLicgKyB0aGlzLnBhcmFtKCd1bml0Q2xhc3MnKSlcbiAgICAgIC5kYXRhKHRoaXMuZGF0YSgpKTtcblxuICAgIHZhciBzZWwgPSB0aGlzLml0ZW1zLmVudGVyKClcbiAgICAgIC5hcHBlbmQoJ2cnKVxuICAgICAgLmNsYXNzZWQoJ2l0ZW0nLCB0cnVlKVxuICAgICAgLmNsYXNzZWQodGhpcy5wYXJhbSgndW5pdENsYXNzJyksIHRydWUpO1xuXG4gICAgdmFyIGhhbmRsZUhlaWdodCA9IDg7XG4gICAgdmFyIHkgPSB0aGlzLnBhcmFtKCdkaXNwbGF5SGFuZGxlJykgPyBoYW5kbGVIZWlnaHQgOiAwO1xuXG4gICAgc2VsLmFwcGVuZCgnbGluZScpXG4gICAgICAuc3R5bGUoJ3N0cm9rZS13aWR0aCcsIHRoaXMud2lkdGgoKSlcbiAgICAgIC5zdHlsZSgnc3Ryb2tlJywgdGhpcy5jb2xvcigpKVxuICAgICAgLnN0eWxlKCdvcGFjaXR5JywgdGhpcy5vcGFjaXR5KCkpXG4gICAgICAuYXR0cigneDEnLCAwKVxuICAgICAgLmF0dHIoJ3gyJywgMClcbiAgICAgIC5hdHRyKCd5MScsIHkpXG4gICAgICAuYXR0cigneTInLCB0aGlzLnBhcmFtKCdoZWlnaHQnKSk7XG5cbiAgICBpZiAodGhpcy5wYXJhbSgnZGlzcGxheUhhbmRsZScpKSB7XG4gICAgICB2YXIgYXJlYSA9IHRoaXMuZDMuc3ZnLmFyZWEoKVxuICAgICAgICAueChmdW5jdGlvbihkKSB7IHJldHVybiBkOyB9KVxuICAgICAgICAueTAoMClcbiAgICAgICAgLnkxKGhhbmRsZUhlaWdodCk7XG5cbiAgICAgIHNlbC5hcHBlbmQoJ3BhdGgnKVxuICAgICAgICAuYXR0cignZCcsIGFyZWEoWy00LCA0XSkpXG4gICAgICAgIC5zdHlsZSgnb3BhY2l0eScsIHRoaXMub3BhY2l0eSgpKVxuICAgICAgICAuc3R5bGUoJ2ZpbGwnLCB0aGlzLmNvbG9yKCkpO1xuICAgIH1cblxuICAgIHRoaXMuaXRlbXMuZXhpdCgpLnJlbW92ZSgpO1xuICB9XG5cbiAgZHJhdyhlbCA9IG51bGwpIHtcbiAgICBlbCA9IGVsIHx8IHRoaXMuaXRlbXM7XG5cbiAgICB2YXIgeFNjYWxlID0gdGhpcy5iYXNlLnhTY2FsZTtcbiAgICB2YXIgeEFjY2Vzc29yID0gdGhpcy54KCk7XG4gICAgdmFyIHggPSAoZCkgPT4geyByZXR1cm4geFNjYWxlKHhBY2Nlc3NvcihkKSk7IH07XG5cbiAgICBlbC5hdHRyKCd0cmFuc2Zvcm0nLCAoZCkgPT4ge1xuICAgICAgcmV0dXJuICd0cmFuc2xhdGUoJyArIHgoZCkgKyAnLCAwKSc7XG4gICAgfSk7XG4gIH1cbn1cblxuYWNjZXNzb3JzLmdldEZ1bmN0aW9uKE1hcmtlci5wcm90b3R5cGUsXG4gIFsnY29sb3InLCAnb3BhY2l0eScsICd3aWR0aCcsICd4J11cbik7XG5cbmZ1bmN0aW9uIGZhY3RvcnkoKSB7IHJldHVybiBuZXcgTWFya2VyKCk7IH1cbmZhY3RvcnkuTWFya2VyID0gTWFya2VyO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZhY3Rvcnk7XG4iXX0=