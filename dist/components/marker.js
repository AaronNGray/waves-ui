"use strict";

var _babelHelpers = require("babel-runtime/helpers")["default"];

var _core = require("babel-runtime/core-js")["default"];

var _require = require("../helpers/utils");

var uniqueId = _require.uniqueId;
var accessors = _require.accessors;

var _require2 = require("../core/layer");

var Layer = _require2.Layer;

var Marker = (function (Layer) {
  function Marker() {
    _babelHelpers.classCallCheck(this, Marker);

    _babelHelpers.get(_core.Object.getPrototypeOf(Marker.prototype), "constructor", this).call(this);

    var defaults = {
      type: "marker",
      id: uniqueId(name),
      displayHandle: true
    };

    this.params(defaults);
    this.width(1);
    this.color("#000000");
    this.opacity("0.7");
    this.data([{ x: 0 }]);

    this.x(function (d) {
      var v = arguments[1] === undefined ? null : arguments[1];

      if (v === null) {
        return d.x;
      }
      d.x = parseFloat(v, 10);
    });
  }

  _babelHelpers.inherits(Marker, Layer);

  _babelHelpers.prototypeProperties(Marker, null, {
    xZoom: {
      value: function xZoom() {
        this.update();
      },
      writable: true,
      configurable: true
    },
    setCurrentTime: {
      value: function setCurrentTime(currentTime) {
        var x = this.x();

        if (!Array.isArray(currentTime)) {
          x(this.data()[0], currentTime);
        } else {
          this.data(currentTime);
        }

        return this;
      },
      writable: true,
      configurable: true
    },
    handleDrag: {
      value: function handleDrag(el, e) {
        this.move(el, e.originalEvent.dx, e.originalEvent.dy);
      },
      writable: true,
      configurable: true
    },
    move: {
      value: function move(item, dx, dy) {
        item = this.d3.select(item);
        var datum = item.datum();

        var xScale = this.base.xScale;
        var xRange = xScale.range();
        var xAccessor = this.x();
        var x = xScale(xAccessor(datum));
        var targetX = x + dx;

        if (targetX >= xRange[0] && targetX <= xRange[1]) {
          x = targetX;
        }

        xAccessor(datum, xScale.invert(x));
        // redraw element
        this.draw(item);
      },
      writable: true,
      configurable: true
    },
    update: {
      value: function update() {
        var data = arguments[0] === undefined ? null : arguments[0];

        if (data !== null && !Array.isArray(data)) {
          data = [data];
        }
        _babelHelpers.get(_core.Object.getPrototypeOf(Marker.prototype), "update", this).call(this, data);

        this.items = this.g.selectAll("." + this.param("unitClass")).data(this.data());

        var sel = this.items.enter().append("g").classed("item", true).classed(this.param("unitClass"), true);

        var handleHeight = 8;
        var y = this.param("displayHandle") ? handleHeight : 0;

        sel.append("line").style("stroke-width", this.width()).style("stroke", this.color()).style("opacity", this.opacity()).attr("x1", 0).attr("x2", 0).attr("y1", y).attr("y2", this.param("height"));

        if (this.param("displayHandle")) {
          var area = this.d3.svg.area().x(function (d) {
            return d;
          }).y0(0).y1(handleHeight);

          sel.append("path").attr("d", area([-4, 4])).style("opacity", this.opacity()).style("fill", this.color());
        }

        this.items.exit().remove();
      },
      writable: true,
      configurable: true
    },
    draw: {
      value: function draw() {
        var el = arguments[0] === undefined ? null : arguments[0];

        el = el || this.items;

        var xScale = this.base.xScale;
        var xAccessor = this.x();
        var x = function (d) {
          return xScale(xAccessor(d));
        };

        el.attr("transform", function (d) {
          return "translate(" + x(d) + ", 0)";
        });
      },
      writable: true,
      configurable: true
    }
  });

  return Marker;
})(Layer);

accessors.getFunction(Marker.prototype, ["color", "opacity", "width", "x"]);

function factory() {
  return new Marker();
}
factory.Marker = Marker;

module.exports = factory;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9oZWxwZXJzL3pvb21lci5lczYuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O2VBRThCLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQzs7SUFBbkQsUUFBUSxZQUFSLFFBQVE7SUFBRSxTQUFTLFlBQVQsU0FBUzs7Z0JBQ1QsT0FBTyxDQUFDLGVBQWUsQ0FBQzs7SUFBbEMsS0FBSyxhQUFMLEtBQUs7O0lBRUwsTUFBTSxjQUFTLEtBQUs7QUFFYixXQUZQLE1BQU07dUNBQU4sTUFBTTs7QUFHUixrREFIRSxNQUFNLDZDQUdBOztBQUVSLFFBQUksUUFBUSxHQUFHO0FBQ2IsVUFBSSxFQUFFLFFBQVE7QUFDZCxRQUFFLEVBQUUsUUFBUSxDQUFDLElBQUksQ0FBQztBQUNsQixtQkFBYSxFQUFFLElBQUk7S0FDcEIsQ0FBQzs7QUFFRixRQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ3RCLFFBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDZCxRQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ3RCLFFBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDcEIsUUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQzs7QUFFdEIsUUFBSSxDQUFDLENBQUMsQ0FBQyxVQUFTLENBQUMsRUFBWTtVQUFWLENBQUMsZ0NBQUcsSUFBSTs7QUFDekIsVUFBSSxDQUFDLEtBQUssSUFBSSxFQUFFO0FBQUUsZUFBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO09BQUU7QUFDL0IsT0FBQyxDQUFDLENBQUMsR0FBRyxVQUFVLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0tBQ3pCLENBQUMsQ0FBQztHQUNKOzt5QkFyQkcsTUFBTSxFQUFTLEtBQUs7O29DQUFwQixNQUFNO0FBdUJWLFNBQUs7YUFBQSxpQkFBRztBQUNOLFlBQUksQ0FBQyxN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QUFHLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDO0FBQzlCLFlBQUksU0FBUyxHQUFHLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQztBQUN6QixZQUFJLENBQUMsR0FBRyxVQUFDLENBQUMsRUFBSztBQUFFLGlCQUFPLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUFFLENBQUM7O0FBRWhELFVBQUUsQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLFVBQUMsQ0FBQyxFQUFLO0FBQzFCLGlCQUFPLFlBQVksR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsTUFBTSxDQUFDO1NBQ3JDLENBQUMsQ0FBQztPQUNKOzs7Ozs7U0EvR0csTUFBTTtHQUFTLEtBQUs7O0FBa0gxQixTQUFTLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxTQUFTLEVBQ3BDLENBQUMsT0FBTyxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQ25DLENBQUM7O0FBRUYsU0FBUyxPQUFPLEdBQUc7QUFBRSxTQUFPLElBQUksTUFBTSxFQUFFLENBQUM7Q0FBRTtBQUMzQyxPQUFPLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQzs7QUFFeEIsTUFBTSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMiLCJmaWxlIjoic3JjL2hlbHBlcnMvem9vbWVyLmVzNi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIHsgdW5pcXVlSWQsIGFjY2Vzc29ycyB9ID0gcmVxdWlyZSgnLi4vaGVscGVycy91dGlscycpO1xudmFyIHsgTGF5ZXIgfSA9IHJlcXVpcmUoJy4uL2NvcmUvbGF5ZXInKTtcblxuY2xhc3MgTWFya2VyIGV4dGVuZHMgTGF5ZXIge1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG5cbiAgICB2YXIgZGVmYXVsdHMgPSB7XG4gICAgICB0eXBlOiAnbWFya2VyJyxcbiAgICAgIGlkOiB1bmlxdWVJZChuYW1lKSxcbiAgICAgIGRpc3BsYXlIYW5kbGU6IHRydWVcbiAgICB9O1xuXG4gICAgdGhpcy5wYXJhbXMoZGVmYXVsdHMpO1xuICAgIHRoaXMud2lkdGgoMSk7XG4gICAgdGhpcy5jb2xvcignIzAwMDAwMCcpO1xuICAgIHRoaXMub3BhY2l0eSgnMC43Jyk7XG4gICAgdGhpcy5kYXRhKFt7IHg6IDAgfV0pO1xuXG4gICAgdGhpcy54KGZ1bmN0aW9uKGQsIHYgPSBudWxsKSB7XG4gICAgICBpZiAodiA9PT0gbnVsbCkgeyByZXR1cm4gZC54OyB9XG4gICAgICBkLnggPSBwYXJzZUZsb2F0KHYsIDEwKTtcbiAgICB9KTtcbiAgfVxuXG4gIHhab29tKCkge1xuICAgIHRoaXMudXBkYXRlKCk7XG4gIH1cblxuICBzZXRDdXJyZW50VGltZShjdXJyZW50VGltZSkge1xuICAgIHZhciB4ID0gdGhpcy54KCk7XG5cbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoY3VycmVudFRpbWUpKSB7XG4gICAgICB4KHRoaXMuZGF0YSgpWzBdLCBjdXJyZW50VGltZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZGF0YShjdXJyZW50VGltZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBoYW5kbGVEcmFnKGVsLCBlKSB7XG4gICAgdGhpcy5tb3ZlKGVsLCBlLm9yaWdpbmFsRXZlbnQuZHgsIGUub3JpZ2luYWxFdmVudC5keSk7XG4gIH1cblxuICBtb3ZlKGl0ZW0sIGR4LCBkeSkge1xuICAgIGl0ZW0gPSB0aGlzLmQzLnNlbGVjdChpdGVtKTtcbiAgICB2YXIgZGF0dW0gPSBpdGVtLmRhdHVtKCk7XG5cbiAgICB2YXIgeFNjYWxlID0gdGhpcy5iYXNlLnhTY2FsZTtcbiAgICB2YXIgeFJhbmdlID0geFNjYWxlLnJhbmdlKCk7XG4gICAgdmFyIHhBY2Nlc3NvciA9IHRoaXMueCgpO1xuICAgIHZhciB4ID0geFNjYWxlKHhBY2Nlc3NvcihkYXR1bSkpO1xuICAgIHZhciB0YXJnZXRYID0geCArIGR4O1xuXG4gICAgaWYgKHRhcmdldFggPj0geFJhbmdlWzBdICYmIHRhcmdldFggPD0geFJhbmdlWzFdKSB7XG4gICAgICB4ID0gdGFyZ2V0WDtcbiAgICB9XG5cbiAgICB4QWNjZXNzb3IoZGF0dW0sIHhTY2FsZS5pbnZlcnQoeCkpO1xuICAgIC8vIHJlZHJhdyBlbGVtZW50XG4gICAgdGhpcy5kcmF3KGl0ZW0pO1xuICB9XG5cbiAgdXBkYXRlKGRhdGEgPSBudWxsKSB7XG4gICAgaWYgKGRhdGEgIT09IG51bGwgJiYgIUFycmF5LmlzQXJyYXkoZGF0YSkpIHsgZGF0YSA9IFtkYXRhXTsgfVxuICAgIHN1cGVyLnVwZGF0ZShkYXRhKTtcblxuICAgIHRoaXMuaXRlbXMgPSB0aGlzLmcuc2VsZWN0QWxsKCcuJyArIHRoaXMucGFyYW0oJ3VuaXRDbGFzcycpKVxuICAgICAgLmRhdGEodGhpcy5kYXRhKCkpO1xuXG4gICAgdmFyIHNlbCA9IHRoaXMuaXRlbXMuZW50ZXIoKVxuICAgICAgLmFwcGVuZCgnZycpXG4gICAgICAuY2xhc3NlZCgnaXRlbScsIHRydWUpXG4gICAgICAuY2xhc3NlZCh0aGlzLnBhcmFtKCd1bml0Q2xhc3MnKSwgdHJ1ZSk7XG5cbiAgICB2YXIgaGFuZGxlSGVpZ2h0ID0gODtcbiAgICB2YXIgeSA9IHRoaXMucGFyYW0oJ2Rpc3BsYXlIYW5kbGUnKSA/IGhhbmRsZUhlaWdodCA6IDA7XG5cbiAgICBzZWwuYXBwZW5kKCdsaW5lJylcbiAgICAgIC5zdHlsZSgnc3Ryb2tlLXdpZHRoJywgdGhpcy53aWR0aCgpKVxuICAgICAgLnN0eWxlKCdzdHJva2UnLCB0aGlzLmNvbG9yKCkpXG4gICAgICAuc3R5bGUoJ29wYWNpdHknLCB0aGlzLm9wYWNpdHkoKSlcbiAgICAgIC5hdHRyKCd4MScsIDApXG4gICAgICAuYXR0cigneDInLCAwKVxuICAgICAgLmF0dHIoJ3kxJywgeSlcbiAgICAgIC5hdHRyKCd5MicsIHRoaXMucGFyYW0oJ2hlaWdodCcpKTtcblxuICAgIGlmICh0aGlzLnBhcmFtKCdkaXNwbGF5SGFuZGxlJykpIHtcbiAgICAgIHZhciBhcmVhID0gdGhpcy5kMy5zdmcuYXJlYSgpXG4gICAgICAgIC54KGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQ7IH0pXG4gICAgICAgIC55MCgwKVxuICAgICAgICAueTEoaGFuZGxlSGVpZ2h0KTtcblxuICAgICAgc2VsLmFwcGVuZCgncGF0aCcpXG4gICAgICAgIC5hdHRyKCdkJywgYXJlYShbLTQsIDRdKSlcbiAgICAgICAgLnN0eWxlKCdvcGFjaXR5JywgdGhpcy5vcGFjaXR5KCkpXG4gICAgICAgIC5zdHlsZSgnZmlsbCcsIHRoaXMuY29sb3IoKSk7XG4gICAgfVxuXG4gICAgdGhpcy5pdGVtcy5leGl0KCkucmVtb3ZlKCk7XG4gIH1cblxuICBkcmF3KGVsID0gbnVsbCkge1xuICAgIGVsID0gZWwgfHwgdGhpcy5pdGVtcztcblxuICAgIHZhciB4U2NhbGUgPSB0aGlzLmJhc2UueFNjYWxlO1xuICAgIHZhciB4QWNjZXNzb3IgPSB0aGlzLngoKTtcbiAgICB2YXIgeCA9IChkKSA9PiB7IHJldHVybiB4U2NhbGUoeEFjY2Vzc29yKGQpKTsgfTtcblxuICAgIGVsLmF0dHIoJ3RyYW5zZm9ybScsIChkKSA9PiB7XG4gICAgICByZXR1cm4gJ3RyYW5zbGF0ZSgnICsgeChkKSArICcsIDApJztcbiAgICB9KTtcbiAgfVxufVxuXG5hY2Nlc3NvcnMuZ2V0RnVuY3Rpb24oTWFya2VyLnByb3RvdHlwZSxcbiAgWydjb2xvcicsICdvcGFjaXR5JywgJ3dpZHRoJywgJ3gnXVxuKTtcblxuZnVuY3Rpb24gZmFjdG9yeSgpIHsgcmV0dXJuIG5ldyBNYXJrZXIoKTsgfVxuZmFjdG9yeS5NYXJrZXIgPSBNYXJrZXI7XG5cbm1vZHVsZS5leHBvcnRzID0gZmFjdG9yeTtcbiJdfQ==