"use strict";

var renderingStrategies = {
  // canvas drawing strategy - performance isssues with foreign object
  canvas: {
    update: function update() {
      this.g.append("foreignObject").attr("width", this.param("width")).attr("height", this.param("height")).append("xhtml:canvas").attr("width", this.param("width")).attr("height", this.param("height")).classed(this.param("unitClass"), true);
    },

    draw: function draw(data) {
      var _this = this;

      var el = this.g.selectAll("." + this.param("unitClass")).node();
      var ctx = this.ctx = this.ctx || el.getContext("2d");

      var width = ctx.canvas.width = this.param("width");
      var height = ctx.canvas.height = this.param("height");
      // var center = height / 2;
      var color = this.color();

      var length = data.length - 2;

      var _y = function (d) {
        return _this.yScale(d);
      };
      var _x = function (i) {
        return _this.base.xScale(_this.xxScale(i));
      };

      ctx.beginPath();
      ctx.strokeStyle = color();
      ctx.fillStyle = color();
      // ctx.moveTo(0, center);

      for (var i = 0; i < length; i += 2) {
        var x = i / 2;
        var x1 = _x(i);
        var x2 = _x(i + 2);

        ctx.moveTo(x1, _y(data[i]));
        ctx.lineTo(x1, _y(data[i + 1]));
        ctx.lineTo(x2, _y(data[i + 3]));
        ctx.lineTo(x2, _y(data[i + 2]));
        ctx.lineTo(x1, _y(data[i]));
      }

      ctx.closePath();
      ctx.fill();
      ctx.stroke();
    }
  },

  svg: {
    update: function update() {
      if (this.path) {
        return;
      }
      var color = this.color();

      this.path = this.g.append("path").classed("item", true).classed(this.param("unitClass"), true).style("fill", color()).style("stroke", color()).style("shape-rendering", "crispEdges");
    },

    draw: function draw(data) {
      var _this = this;

      var d3 = this.d3;
      var _y = function (d) {
        return _this.yScale(d);
      };
      var _x = function (i) {
        return _this.base.xScale(_this.xxScale(i));
      };

      var xRange = this.base.xScale.range();
      var currentX;

      this.area = d3.svg.area().defined(function (d, i) {
        currentX = _x(i);
        return currentX >= xRange[0] && currentX <= xRange[1];
      }).x(function (d, i) {
        return currentX;
      }).y0(function (d, i) {
        return i % 2 === 0 ? _y(data[i]) : _y(data[i - 1]);
      }).y1(function (d, i) {
        return i % 2 === 0 ? _y(data[i + 1]) : _y(data[i]);
      });

      var color = this.color();
      var pathStr = this.area(data);

      this.path.attr("d", pathStr);
      pathStr = undefined;
    }
  }
};

module.exports = renderingStrategies;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9oZWxwZXJzL3pvb21lci5lczYuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFFQSxJQUFJLG1CQUFtQixHQUFHOztBQUV4QixRQUFNLEVBQUU7QUFDTixVQUFNLEVBQUUsa0JBQVc7QUFDakIsVUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsZUFBZSxDQUFDLENBQzNCLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUNsQyxJQUFJLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FDcEMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUNwQixJQUFJLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FDbEMsSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQ3BDLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQzdDOztBQUVELFFBQUksRUFBRSxjQUFTLElBQUksRUFBRTs7O0FBQ25CLFVBQUksRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7QUFDaEUsVUFBSSxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxJQUFJLEVBQUUsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7O0FBRXJELFVBQUksS0FBSyxHQUFHLEdBQUcsQ0FBQyxNQUFNLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDbkQsVUFBSSxNQUFNLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxN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SUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO0FBQ3pCLFVBQUksT0FBTyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7O0FBRTlCLFVBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUM3QixhQUFPLEdBQUcsU0FBUyxDQUFDO0tBQ3JCO0dBQ0Y7Q0FDRixDQUFDOztBQUVGLE1BQU0sQ0FBQyxPQUFPLEdBQUcsbUJBQW1CLENBQUMiLCJmaWxlIjoic3JjL2hlbHBlcnMvem9vbWVyLmVzNi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxudmFyIHJlbmRlcmluZ1N0cmF0ZWdpZXMgPSB7XG4gIC8vIGNhbnZhcyBkcmF3aW5nIHN0cmF0ZWd5IC0gcGVyZm9ybWFuY2UgaXNzc3VlcyB3aXRoIGZvcmVpZ24gb2JqZWN0XG4gIGNhbnZhczoge1xuICAgIHVwZGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgICB0aGlzLmcuYXBwZW5kKCdmb3JlaWduT2JqZWN0JylcbiAgICAgICAgLmF0dHIoJ3dpZHRoJywgdGhpcy5wYXJhbSgnd2lkdGgnKSlcbiAgICAgICAgLmF0dHIoJ2hlaWdodCcsIHRoaXMucGFyYW0oJ2hlaWdodCcpKVxuICAgICAgICAuYXBwZW5kKCd4aHRtbDpjYW52YXMnKVxuICAgICAgICAgIC5hdHRyKCd3aWR0aCcsIHRoaXMucGFyYW0oJ3dpZHRoJykpXG4gICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIHRoaXMucGFyYW0oJ2hlaWdodCcpKVxuICAgICAgICAgIC5jbGFzc2VkKHRoaXMucGFyYW0oJ3VuaXRDbGFzcycpLCB0cnVlKTtcbiAgICB9LFxuXG4gICAgZHJhdzogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgdmFyIGVsID0gdGhpcy5nLnNlbGVjdEFsbCgnLicgKyB0aGlzLnBhcmFtKCd1bml0Q2xhc3MnKSkubm9kZSgpO1xuICAgICAgdmFyIGN0eCA9IHRoaXMuY3R4ID0gdGhpcy5jdHggfHwgZWwuZ2V0Q29udGV4dCgnMmQnKTtcblxuICAgICAgdmFyIHdpZHRoID0gY3R4LmNhbnZhcy53aWR0aCA9IHRoaXMucGFyYW0oJ3dpZHRoJyk7XG4gICAgICB2YXIgaGVpZ2h0ID0gY3R4LmNhbnZhcy5oZWlnaHQgPSB0aGlzLnBhcmFtKCdoZWlnaHQnKTtcbiAgICAgIC8vIHZhciBjZW50ZXIgPSBoZWlnaHQgLyAyO1xuICAgICAgdmFyIGNvbG9yID0gdGhpcy5jb2xvcigpO1xuXG4gICAgICB2YXIgbGVuZ3RoID0gZGF0YS5sZW5ndGggLSAyO1xuXG4gICAgICB2YXIgX3kgPSAoZCkgPT4geyByZXR1cm4gdGhpcy55U2NhbGUoZCk7IH07XG4gICAgICB2YXIgX3ggPSAoaSkgPT4geyByZXR1cm4gdGhpcy5iYXNlLnhTY2FsZSh0aGlzLnh4U2NhbGUoaSkpOyB9O1xuXG4gICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICBjdHguc3Ryb2tlU3R5bGUgPSBjb2xvcigpO1xuICAgICAgY3R4LmZpbGxTdHlsZSAgID0gY29sb3IoKTtcbiAgICAgIC8vIGN0eC5tb3ZlVG8oMCwgY2VudGVyKTtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMikge1xuICAgICAgICB2YXIgeCA9IGkgLyAyO1xuICAgICAgICB2YXIgeDEgPSBfeChpKTtcbiAgICAgICAgdmFyIHgyID0gX3goaSArIDIpO1xuXG4gICAgICAgIGN0eC5tb3ZlVG8oeDEsIF95KGRhdGFbaV0pKTtcbiAgICAgICAgY3R4LmxpbmVUbyh4MSwgX3koZGF0YVtpICsgMV0pKTtcbiAgICAgICAgY3R4LmxpbmVUbyh4MiwgX3koZGF0YVtpICsgM10pKTtcbiAgICAgICAgY3R4LmxpbmVUbyh4MiwgX3koZGF0YVtpICsgMl0pKTtcbiAgICAgICAgY3R4LmxpbmVUbyh4MSwgX3koZGF0YVtpXSkpO1xuICAgICAgfVxuXG4gICAgICBjdHguY2xvc2VQYXRoKCk7XG4gICAgICBjdHguZmlsbCgpO1xuICAgICAgY3R4LnN0cm9rZSgpO1xuICAgIH1cbiAgfSxcblxuICBzdmc6IHtcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKHRoaXMucGF0aCkgeyByZXR1cm47IH1cbiAgICAgIHZhciBjb2xvciA9IHRoaXMuY29sb3IoKTtcblxuICAgICAgdGhpcy5wYXRoID0gdGhpcy5nXG4gICAgICAgIC5hcHBlbmQoJ3BhdGgnKVxuICAgICAgICAuY2xhc3NlZCgnaXRlbScsIHRydWUpXG4gICAgICAgIC5jbGFzc2VkKHRoaXMucGFyYW0oJ3VuaXRDbGFzcycpLCB0cnVlKVxuICAgICAgICAuc3R5bGUoJ2ZpbGwnLCBjb2xvcigpKVxuICAgICAgICAuc3R5bGUoJ3N0cm9rZScsIGNvbG9yKCkpXG4gICAgICAgIC5zdHlsZSgnc2hhcGUtcmVuZGVyaW5nJywgJ2NyaXNwRWRnZXMnKTtcbiAgICB9LFxuXG4gICAgZHJhdzogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgdmFyIGQzID0gdGhpcy5kMztcbiAgICAgIHZhciBfeSA9IChkKSA9PiB7IHJldHVybiB0aGlzLnlTY2FsZShkKTsgfTtcbiAgICAgIHZhciBfeCA9IChpKSA9PiB7IHJldHVybiB0aGlzLmJhc2UueFNjYWxlKHRoaXMueHhTY2FsZShpKSk7IH07XG5cbiAgICAgIHZhciB4UmFuZ2UgPSB0aGlzLmJhc2UueFNjYWxlLnJhbmdlKCk7XG4gICAgICB2YXIgY3VycmVudFg7XG5cbiAgICAgIHRoaXMuYXJlYSA9IGQzLnN2Zy5hcmVhKClcbiAgICAgICAgLmRlZmluZWQoZnVuY3Rpb24oZCwgaSkge1xuICAgICAgICAgIGN1cnJlbnRYID0gX3goaSk7XG4gICAgICAgICAgcmV0dXJuIChjdXJyZW50WCA+PSB4UmFuZ2VbMF0gJiYgY3VycmVudFggPD0geFJhbmdlWzFdKTtcbiAgICAgICAgfSlcbiAgICAgICAgLngoKGQsIGkpID0+IHsgcmV0dXJuIGN1cnJlbnRYOyB9KVxuICAgICAgICAueTAoKGQsIGkpID0+IHsgcmV0dXJuIGkgJSAyID09PSAwID8gX3koZGF0YVtpXSkgOiBfeShkYXRhW2kgLSAxXSk7IH0pXG4gICAgICAgIC55MSgoZCwgaSkgPT4geyByZXR1cm4gaSAlIDIgPT09IDAgPyBfeShkYXRhW2kgKyAxXSkgOiBfeShkYXRhW2ldKTsgfSk7XG5cbiAgICAgIHZhciBjb2xvciA9IHRoaXMuY29sb3IoKTtcbiAgICAgIHZhciBwYXRoU3RyID0gdGhpcy5hcmVhKGRhdGEpO1xuXG4gICAgICB0aGlzLnBhdGguYXR0cignZCcsIHBhdGhTdHIpO1xuICAgICAgcGF0aFN0ciA9IHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gcmVuZGVyaW5nU3RyYXRlZ2llcztcbiJdfQ==