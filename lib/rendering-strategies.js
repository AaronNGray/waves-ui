"use strict";

var renderingStrategies = {
  // canvas drawing strategy - performance isssues with foreign object
  canvas: {
    update: function () {
      this.g.append("foreignObject").attr("width", this.param("width")).attr("height", this.param("height")).append("xhtml:canvas").attr("width", this.param("width")).attr("height", this.param("height")).classed(this.param("unitClass"), true);
    },

    draw: function (data) {
      var _this = this;
      var el = this.g.selectAll("." + this.param("unitClass")).node();
      var ctx = this.ctx = this.ctx || el.getContext("2d");

      var width = ctx.canvas.width = this.param("width");
      var height = ctx.canvas.height = this.param("height");
      // var center = height / 2;
      var color = this.color();

      var length = data.length - 2;

      var _y = function (d) {
        return _this.yScale(d);
      };
      var _x = function (i) {
        return _this.base.xScale(_this.xxScale(i));
      };

      ctx.beginPath();
      ctx.strokeStyle = color();
      ctx.fillStyle = color();
      // ctx.moveTo(0, center);

      for (var i = 0; i < length; i += 2) {
        var x = i / 2;
        var x1 = _x(i);
        var x2 = _x(i + 2);

        ctx.moveTo(x1, _y(data[i]));
        ctx.lineTo(x1, _y(data[i + 1]));
        ctx.lineTo(x2, _y(data[i + 3]));
        ctx.lineTo(x2, _y(data[i + 2]));
        ctx.lineTo(x1, _y(data[i]));
      }

      ctx.closePath();
      ctx.fill();
      ctx.stroke();
    }
  },

  svg: {
    update: function () {
      if (this.path) {
        return;
      }
      var color = this.color();

      this.path = this.g.append("path").classed("item", true).classed(this.param("unitClass"), true).style("fill", color()).style("stroke", color()).style("shape-rendering", "crispEdges");
    },

    draw: function (data) {
      var _this = this;
      var d3 = this.d3;
      var _y = function (d) {
        return _this.yScale(d);
      };
      var _x = function (i) {
        return _this.base.xScale(_this.xxScale(i));
      };

      var xRange = this.base.xScale.range();
      var currentX;

      this.area = d3.svg.area().defined(function (d, i) {
        currentX = _x(i);
        return currentX >= xRange[0] && currentX <= xRange[1];
      }).x(function (d, i) {
        return currentX;
      }).y0(function (d, i) {
        return i % 2 === 0 ? _y(data[i]) : _y(data[i - 1]);
      }).y1(function (d, i) {
        return i % 2 === 0 ? _y(data[i + 1]) : _y(data[i]);
      });

      var color = this.color();
      var pathStr = this.area(data);

      this.path.attr("d", pathStr);
      pathStr = undefined;
    }
  }
};

module.exports = renderingStrategies;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vbGliL3JlbmRlcmluZy1zdHJhdGVnaWVzLmVzNi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxZQUFZLENBQUM7O0FBRWIsSUFBSSxtQkFBbUIsR0FBRzs7QUFFeEIsUUFBTSxFQUFFO0FBQ04sVUFBTSxFQUFFLFlBQVc7QUFDakIsVUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsZUFBZSxDQUFDLENBQzNCLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUNsQyxJQUFJLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FDcEMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUNwQixJQUFJLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FDbEMsSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQ3BDLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQzdDOztBQUVELFFBQUksRUFBRSxVQUFTLElBQUksRUFBRTs7QUFDbkIsVUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUNoRSxVQUFJLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLElBQUksRUFBRSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQzs7QUFFckQsVUFBSSxLQUFLLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUNuRCxVQUFJLE1BQU0sR0FBRyxH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ekUsVUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO0FBQ3pCLFVBQUksT0FBTyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7O0FBRTlCLFVBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUM3QixhQUFPLEdBQUcsU0FBUyxDQUFDO0tBQ3JCO0dBQ0Y7Q0FDRixDQUFDOztBQUVGLE1BQU0sQ0FBQyxPQUFPLEdBQUcsbUJBQW1CLENBQUMiLCJmaWxlIjoiLi9saWIvcmVuZGVyaW5nLXN0cmF0ZWdpZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciByZW5kZXJpbmdTdHJhdGVnaWVzID0ge1xuICAvLyBjYW52YXMgZHJhd2luZyBzdHJhdGVneSAtIHBlcmZvcm1hbmNlIGlzc3N1ZXMgd2l0aCBmb3JlaWduIG9iamVjdFxuICBjYW52YXM6IHtcbiAgICB1cGRhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgdGhpcy5nLmFwcGVuZCgnZm9yZWlnbk9iamVjdCcpXG4gICAgICAgIC5hdHRyKCd3aWR0aCcsIHRoaXMucGFyYW0oJ3dpZHRoJykpXG4gICAgICAgIC5hdHRyKCdoZWlnaHQnLCB0aGlzLnBhcmFtKCdoZWlnaHQnKSlcbiAgICAgICAgLmFwcGVuZCgneGh0bWw6Y2FudmFzJylcbiAgICAgICAgICAuYXR0cignd2lkdGgnLCB0aGlzLnBhcmFtKCd3aWR0aCcpKVxuICAgICAgICAgIC5hdHRyKCdoZWlnaHQnLCB0aGlzLnBhcmFtKCdoZWlnaHQnKSlcbiAgICAgICAgICAuY2xhc3NlZCh0aGlzLnBhcmFtKCd1bml0Q2xhc3MnKSwgdHJ1ZSk7XG4gICAgfSxcblxuICAgIGRyYXc6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHZhciBlbCA9IHRoaXMuZy5zZWxlY3RBbGwoJy4nICsgdGhpcy5wYXJhbSgndW5pdENsYXNzJykpLm5vZGUoKTtcbiAgICAgIHZhciBjdHggPSB0aGlzLmN0eCA9IHRoaXMuY3R4IHx8IGVsLmdldENvbnRleHQoJzJkJyk7XG5cbiAgICAgIHZhciB3aWR0aCA9IGN0eC5jYW52YXMud2lkdGggPSB0aGlzLnBhcmFtKCd3aWR0aCcpO1xuICAgICAgdmFyIGhlaWdodCA9IGN0eC5jYW52YXMuaGVpZ2h0ID0gdGhpcy5wYXJhbSgnaGVpZ2h0Jyk7XG4gICAgICAvLyB2YXIgY2VudGVyID0gaGVpZ2h0IC8gMjtcbiAgICAgIHZhciBjb2xvciA9IHRoaXMuY29sb3IoKTtcblxuICAgICAgdmFyIGxlbmd0aCA9IGRhdGEubGVuZ3RoIC0gMjtcblxuICAgICAgdmFyIF95ID0gKGQpID0+IHsgcmV0dXJuIHRoaXMueVNjYWxlKGQpOyB9O1xuICAgICAgdmFyIF94ID0gKGkpID0+IHsgcmV0dXJuIHRoaXMuYmFzZS54U2NhbGUodGhpcy54eFNjYWxlKGkpKTsgfTtcblxuICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgY3R4LnN0cm9rZVN0eWxlID0gY29sb3IoKTtcbiAgICAgIGN0eC5maWxsU3R5bGUgICA9IGNvbG9yKCk7XG4gICAgICAvLyBjdHgubW92ZVRvKDAsIGNlbnRlcik7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDIpIHtcbiAgICAgICAgdmFyIHggPSBpIC8gMjtcbiAgICAgICAgdmFyIHgxID0gX3goaSk7XG4gICAgICAgIHZhciB4MiA9IF94KGkgKyAyKTtcblxuICAgICAgICBjdHgubW92ZVRvKHgxLCBfeShkYXRhW2ldKSk7XG4gICAgICAgIGN0eC5saW5lVG8oeDEsIF95KGRhdGFbaSArIDFdKSk7XG4gICAgICAgIGN0eC5saW5lVG8oeDIsIF95KGRhdGFbaSArIDNdKSk7XG4gICAgICAgIGN0eC5saW5lVG8oeDIsIF95KGRhdGFbaSArIDJdKSk7XG4gICAgICAgIGN0eC5saW5lVG8oeDEsIF95KGRhdGFbaV0pKTtcbiAgICAgIH1cblxuICAgICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgICAgY3R4LmZpbGwoKTtcbiAgICAgIGN0eC5zdHJva2UoKTtcbiAgICB9XG4gIH0sXG5cbiAgc3ZnOiB7XG4gICAgdXBkYXRlOiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICh0aGlzLnBhdGgpIHsgcmV0dXJuOyB9XG4gICAgICB2YXIgY29sb3IgPSB0aGlzLmNvbG9yKCk7XG5cbiAgICAgIHRoaXMucGF0aCA9IHRoaXMuZ1xuICAgICAgICAuYXBwZW5kKCdwYXRoJylcbiAgICAgICAgLmNsYXNzZWQoJ2l0ZW0nLCB0cnVlKVxuICAgICAgICAuY2xhc3NlZCh0aGlzLnBhcmFtKCd1bml0Q2xhc3MnKSwgdHJ1ZSlcbiAgICAgICAgLnN0eWxlKCdmaWxsJywgY29sb3IoKSlcbiAgICAgICAgLnN0eWxlKCdzdHJva2UnLCBjb2xvcigpKVxuICAgICAgICAuc3R5bGUoJ3NoYXBlLXJlbmRlcmluZycsICdjcmlzcEVkZ2VzJyk7XG4gICAgfSxcblxuICAgIGRyYXc6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgIHZhciBkMyA9IHRoaXMuZDM7XG4gICAgICB2YXIgX3kgPSAoZCkgPT4geyByZXR1cm4gdGhpcy55U2NhbGUoZCk7IH07XG4gICAgICB2YXIgX3ggPSAoaSkgPT4geyByZXR1cm4gdGhpcy5iYXNlLnhTY2FsZSh0aGlzLnh4U2NhbGUoaSkpOyB9O1xuXG4gICAgICB2YXIgeFJhbmdlID0gdGhpcy5iYXNlLnhTY2FsZS5yYW5nZSgpO1xuICAgICAgdmFyIGN1cnJlbnRYO1xuXG4gICAgICB0aGlzLmFyZWEgPSBkMy5zdmcuYXJlYSgpXG4gICAgICAgIC5kZWZpbmVkKGZ1bmN0aW9uKGQsIGkpIHtcbiAgICAgICAgICBjdXJyZW50WCA9IF94KGkpO1xuICAgICAgICAgIHJldHVybiAoY3VycmVudFggPj0geFJhbmdlWzBdICYmIGN1cnJlbnRYIDw9IHhSYW5nZVsxXSk7XG4gICAgICAgIH0pXG4gICAgICAgIC54KChkLCBpKSA9PiB7IHJldHVybiBjdXJyZW50WDsgfSlcbiAgICAgICAgLnkwKChkLCBpKSA9PiB7IHJldHVybiBpICUgMiA9PT0gMCA/IF95KGRhdGFbaV0pIDogX3koZGF0YVtpIC0gMV0pOyB9KVxuICAgICAgICAueTEoKGQsIGkpID0+IHsgcmV0dXJuIGkgJSAyID09PSAwID8gX3koZGF0YVtpICsgMV0pIDogX3koZGF0YVtpXSk7IH0pO1xuXG4gICAgICB2YXIgY29sb3IgPSB0aGlzLmNvbG9yKCk7XG4gICAgICB2YXIgcGF0aFN0ciA9IHRoaXMuYXJlYShkYXRhKTtcblxuICAgICAgdGhpcy5wYXRoLmF0dHIoJ2QnLCBwYXRoU3RyKTtcbiAgICAgIHBhdGhTdHIgPSB1bmRlZmluZWQ7XG4gICAgfVxuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJlbmRlcmluZ1N0cmF0ZWdpZXM7XG4iXX0=